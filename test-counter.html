<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>CounterAPI テスト</title>
</head>
<body>
    <h1>CounterAPI 接続テスト</h1>
    
    <h2>アクセスカウンター</h2>
    <button onclick="testAccessCounter()">アクセスカウンターをテスト</button>
    <div id="access-result"></div>
    
    <h2>いいねカウンター</h2>
    <button onclick="testLikeCounter()">いいねカウンターをテスト</button>
    <div id="like-result"></div>
    
    <script>
        const WORKSPACE = 'nikkisite2025';
        const ACCESS_COUNTER = 'totalvisits';
        const LIKE_COUNTER = 'totallikes';
        
        async function testAccessCounter() {
            const resultDiv = document.getElementById('access-result');
            resultDiv.innerHTML = 'テスト中...';
            
            try {
                // まず現在の値を取得 (V2)
                const getUrl = `https://api.counterapi.dev/v2/${WORKSPACE}/${ACCESS_COUNTER}`;
                const getResponse = await fetch(getUrl);
                console.log('GET Response:', getResponse.status);
                
                if (getResponse.ok) {
                    const getData = await getResponse.json();
                    console.log('GET Data:', getData);
                }
                
                // カウントアップ (V2)
                const upUrl = `https://api.counterapi.dev/v2/${WORKSPACE}/${ACCESS_COUNTER}/up`;
                const upResponse = await fetch(upUrl);
                
                if (upResponse.ok) {
                    const upData = await upResponse.json();
                    resultDiv.innerHTML = `
                        <p>成功！現在のカウント: ${upData.data.up_count}</p>
                        <p>APIレスポンス: ${JSON.stringify(upData)}</p>
                    `;
                } else {
                    const errorText = await upResponse.text();
                    resultDiv.innerHTML = `
                        <p style="color: red;">HTTPエラー: ${upResponse.status}</p>
                        <p>${errorText}</p>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">エラー: ${error.message}</p>`;
                console.error('詳細:', error);
            }
        }
        
        async function testLikeCounter() {
            const resultDiv = document.getElementById('like-result');
            resultDiv.innerHTML = 'テスト中...';
            
            try {
                // カウントアップ (V2)
                const upUrl = `https://api.counterapi.dev/v2/${WORKSPACE}/${LIKE_COUNTER}/up`;
                const upResponse = await fetch(upUrl);
                
                if (upResponse.ok) {
                    const upData = await upResponse.json();
                    resultDiv.innerHTML = `
                        <p>成功！現在のカウント: ${upData.data.up_count}</p>
                        <p>APIレスポンス: ${JSON.stringify(upData)}</p>
                    `;
                } else {
                    const errorText = await upResponse.text();
                    resultDiv.innerHTML = `
                        <p style="color: red;">HTTPエラー: ${upResponse.status}</p>
                        <p>${errorText}</p>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">エラー: ${error.message}</p>`;
                console.error('詳細:', error);
            }
        }
    </script>
</body>
</html>